From 8332633ef27ecb4e46fc6c246e3723b0ad2dc19b Mon Sep 17 00:00:00 2001
From: Martin Marmsoler <martin.marmsoler@gmail.com>
Date: Wed, 2 Nov 2022 16:45:04 +0100
Subject: [PATCH 2/2] fix installation with flatpak

---
 source6/ChartGeany/ChartGeany.pro | 13 +++++--------
 1 file changed, 5 insertions(+), 8 deletions(-)

diff --git a/source6/ChartGeany/ChartGeany.pro b/source6/ChartGeany/ChartGeany.pro
index 39aad23..a172b1a 100644
--- a/source6/ChartGeany/ChartGeany.pro
+++ b/source6/ChartGeany/ChartGeany.pro
@@ -129,15 +129,12 @@ QMAKE_CXXFLAGS += -fomit-frame-pointer -fstack-protector
 # QMAKE_STRIP = echo
 QMAKE_POST_LINK += strip $(TARGET)
 
-target.path = /opt/$$PKG_NAME
-images.path = /opt/$$PKG_NAME
-desktop.path = /usr/share/applications/
-images.files = images/$${PKG_NAME}.png
+target.path = $${PREFIX}/bin
+desktop.path = $${PREFIX}/share/applications/
 desktop.files = $${PKG_NAME}.desktop
-chartgeany.path = /opt/$$PKG_NAME
-chartgeany.commands = rm -rf /usr/bin/$$TARGET; ln -s /opt/$$PKG_NAME/$$TARGET /usr/bin
-chartgeany.uninstall = rm -rf /usr/bin/$$TARGET
-INSTALLS += target desktop images chartgeany
+metainfo.path = $${PREFIX}/share/metainfo/
+metainfo.path = $${PGK_NAME}.metainfo.xml
+INSTALLS += target desktop metainfo
 }
 
 #
-- 
2.38.0

